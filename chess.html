<html><pre>

1   <font color='#FF00FF'><b>#include &lt;stdio.h&gt;</b></font>
2   <font color='#FF00FF'><b>#include &lt;stdlib.h&gt;</b></font>
3   <font color='#FF00FF'><b>#include &lt;string.h&gt;</b></font>
4   <font color='#FF00FF'><b>#include &lt;time.h&gt;</b></font>
5   <font color='#FF00FF'><b>#include &quot;stddef.h&quot;</b></font>
6   <font color='#FF00FF'><b>#include &quot;strutil.h&quot;</b></font>
7   <font color='#FF00FF'><b>#include &quot;boardutil.h&quot;</b></font>
8   <font color='#FF00FF'><b>#include &quot;moves.h&quot;</b></font>
9   <font color='#FF00FF'><b>#include &lt;mpi.h&gt;</b></font>
10  <font color='#00FF00'>//General defines</font>
11  <font color='#FF00FF'><b>#define MQ_SIZE 20</b></font>
12  <font color='#FF00FF'><b>#define MAX_REPEATS 3</b></font>
13  <font color='#FF00FF'><b>#define HUMAN 0</b></font>
14  <font color='#FF00FF'><b>#define AI 1</b></font>
15  <font color='#00FF00'>//Setup defines</font>
16  <font color='#FF00FF'><b>#define SEARCH_DEPTH 4</b></font>
17  <font color='#FF00FF'><b>#define TYPE_WHITE HUMAN</b></font>
18  <font color='#FF00FF'><b>#define TYPE_BLACK AI</b></font>
19  <font color='#FF00FF'><b>#define FUNCTION_WHITE TURING</b></font>
20  <font color='#FF00FF'><b>#define FUNCTION_BLACK TURING</b></font>
21  <font color='#00FF00'>//Use MPI namespace</font>
22  <a name='using'><font color='#0000FF'>using</font></a> <a name='namespace'><font color='#0000FF'>namespace</font></a> <a name='MPI'><font color='#0000FF'>MPI</font></a>;
23  <font color='#00FF00'>//Global variables</font>
24  <a name='Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='prev'><font color='#0000FF'>prev</font></a>;
25  <font color='#0000FF'><b>int</font></b> <a name='proc'><font color='#0000FF'>proc</font></a>;
26  <font color='#0000FF'><b>int</font></b> <a name='numProcs'><font color='#0000FF'>numProcs</font></a>;
27  <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><b>* </b><a name='moveQueue'><font color='#0000FF'>moveQueue</font></a>;
28  <font color='#00FF00'>// Queue for storing previously executed moves</font>
29  <font color='#0000FF'><b>int</font></b> <a name='queueIndex'><font color='#0000FF'>queueIndex</font></a>;
30  <font color='#00FF00'>// Current position in array queue</font>
31  <font color='#0000FF'><b>int</font></b> <a name='queueFull'><font color='#0000FF'>queueFull</font></a>;
32  <font color='#00FF00'>// Whether queue has been filled yet</font>
33  <font color='#00FF00'>//Prototypes</font>
34  <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='strToMove'><font color='#0000FF'>strToMove</font></a>(<font color='#0000FF'><b>char</font></b><b>* </b><a name='str'><font color='#0000FF'>str</font></a>);
35  <font color='#0000FF'><b>void</font></b> <a name='printScore'><font color='#0000FF'>printScore</font></a>(<font color='#0000FF'><b>int</font></b> <a name='score'><font color='#0000FF'>score</font></a>);
36  <font color='#0000FF'><b>int</font></b> <a name='movesEqual'><font color='#0000FF'>movesEqual</font></a>(<a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='move1'><font color='#0000FF'>move1</font></a><b>, </b><a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='move2'><font color='#0000FF'>move2</font></a>);
37  <font color='#0000FF'><b>char</font></b> <a name='toUpperCase'><font color='#0000FF'>toUpperCase</font></a>(<font color='#0000FF'><b>int</font></b> <a name='c'><font color='#0000FF'>c</font></a>);
38  <font color='#0000FF'><b>char</font></b> <a name='getColumnChar'><font color='#0000FF'>getColumnChar</font></a>(<font color='#0000FF'><b>int</font></b> <a name='col'><font color='#0000FF'>col</font></a>);
39  <font color='#0000FF'><b>void</font></b> <a name='initLog'><font color='#0000FF'>initLog</font></a>(<font color='#0000FF'><b>const</font></b> <font color='#0000FF'><b>char</font></b><b>* </b><a name='filename'><font color='#0000FF'>filename</font></a>);
40  <font color='#0000FF'><b>void</font></b> <a name='logMove'><font color='#0000FF'>logMove</font></a>(<font color='#0000FF'><b>const</font></b> <font color='#0000FF'><b>char</font></b><b>* </b><a href='#filename'><font color='#0000FF'>filename</font></a><b>, </b><a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='move'><font color='#0000FF'>move</font></a>);
41  <font color='#0000FF'><b>int</font></b> <a name='computeMove'><font color='#0000FF'>computeMove</font></a>(<font color='#0000FF'><b>int</font></b> <a name='userType'><font color='#0000FF'>userType</font></a><b>, </b><font color='#0000FF'><b>char</font></b><b>* </b><a name='board'><font color='#0000FF'>board</font></a><b>, </b><a name='MoveSet'><font color='#0000FF'>MoveSet</font></a><b>* </b><a name='moves'><font color='#0000FF'>moves</font></a><b>, </b><font color='#0000FF'><b>int</font></b> <a name='colorFlag'><font color='#0000FF'>colorFlag</font></a><b>, </b><font color='#0000FF'><b>int</font></b> <a name='evaluator'><font color='#0000FF'>evaluator</font></a>);
42  <font color='#0000FF'><b>void</font></b> <a name='sendKillSig'><font color='#0000FF'>sendKillSig</font></a>();
43  <font color='#0000FF'><b>void</font></b> <a name='enqueueMove'><font color='#0000FF'>enqueueMove</font></a>(<a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move'><font color='#0000FF'>move</font></a>);
44  <font color='#0000FF'><b>int</font></b> <a name='moveLoopDetected'><font color='#0000FF'>moveLoopDetected</font></a>();
45  <font color='#00FF00'>/*
 * Main function.
 */</font>
46  <font color='#0000FF'><b>int</font></b> <a name='main'><font color='#0000FF'>main</font></a>(<font color='#0000FF'><b>int</font></b> <a name='argc'><font color='#0000FF'>argc</font></a><b>, </b><font color='#0000FF'><b>char</font></b><b>* </b><a name='argv'><font color='#0000FF'>argv</font></a>[])
47  {
48      <font color='#00FF00'>//Initialize MPI</font>
49      <a name='Init'><font color='#0000FF'>Init</font></a>(<a href='#argc'><font color='#0000FF'>argc</font></a><b>, </b><a href='#argv'><font color='#0000FF'>argv</font></a>);
50      <a href='#proc'><font color='#0000FF'>proc</font></a> <b>= </b><a name='COMM_WORLD'><font color='#0000FF'>COMM_WORLD</font></a><b>. </b><a name='Get_rank'><font color='#0000FF'>Get_rank</font></a>();
51      <a href='#numProcs'><font color='#0000FF'>numProcs</font></a> <b>= </b><a href='#COMM_WORLD'><font color='#0000FF'>COMM_WORLD</font></a><b>. </b><a name='Get_size'><font color='#0000FF'>Get_size</font></a>();
52      <font color='#00FF00'>//Require at least 1 slave node to run</font>
53      <font color='#0000FF'><b>if</font></b> (<a href='#numProcs'><font color='#0000FF'>numProcs</font></a> <b>&lt; </b><font color='#00FFFF'><i>2</i></font>)
54      {
55          <font color='#0000FF'><b>if</font></b> (<a href='#proc'><font color='#0000FF'>proc</font></a> <b>== </b><a name='HEAD'><font color='#0000FF'>HEAD</font></a>)<a name='printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;Program requires at least 1 slave node to run.\nTerminating.\n&quot;</font>);
56          <a name='Finalize'><font color='#0000FF'>Finalize</font></a>();
57          <font color='#0000FF'><b>return</font></b> <font color='#00FFFF'><i>0</i></font>;
58          
59      }
60      <font color='#00FF00'>//Divide between head and slave node program</font>
61      <font color='#0000FF'><b>if</font></b> (<a href='#proc'><font color='#0000FF'>proc</font></a> <b>== </b><a href='#HEAD'><font color='#0000FF'>HEAD</font></a>)
62      {
63          <font color='#00FF00'>//Head node code</font>
64          <font color='#00FF00'>//======================================================================</font>
65          <font color='#00FF00'>//initialize variables</font>
66          <a href='#queueIndex'><font color='#0000FF'>queueIndex</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
67          <a href='#queueFull'><font color='#0000FF'>queueFull</font></a> <b>= </b><a name='FALSE'><font color='#0000FF'>FALSE</font></a>;
68          <a href='#moveQueue'><font color='#0000FF'>moveQueue</font></a> <b>= </b>(<a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><b>* </b>)<a name='malloc'><font color='#0000FF'>malloc</font></a>(<font color='#0000FF'><b>sizeof</font></b>(<a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b>)<b>* </b><a name='MQ_SIZE'><font color='#0000FF'>MQ_SIZE</font></a>);
69          <font color='#0000FF'><b>int</font></b> <a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>= </b><a name='WHITE'><font color='#0000FF'>WHITE</font></a>;
70          <a href='#MoveSet'><font color='#0000FF'>MoveSet</font></a><b>* </b><a href='#moves'><font color='#0000FF'>moves</font></a>;
71          <font color='#0000FF'><b>char</font></b><b>* </b><a href='#board'><font color='#0000FF'>board</font></a> <b>= </b><a name='buildNewBoard'><font color='#0000FF'>buildNewBoard</font></a>();
72          <font color='#00FF00'>//setup empty previous move</font>
73          <a href='#prev'><font color='#0000FF'>prev</font></a> <b>= </b><a name='newMove'><font color='#0000FF'>newMove</font></a>();
74          <font color='#00FF00'>//resume play from log file if requested</font>
75          <font color='#0000FF'><b>if</font></b> (<a name='streq'><font color='#0000FF'>streq</font></a>(<a href='#argv'><font color='#0000FF'>argv</font></a>[<a href='#argc'><font color='#0000FF'>argc</font></a> <b>- </b><font color='#00FFFF'><i>1</i></font>]<b>, </b>(<font color='#0000FF'><b>char</font></b><b>* </b>)<font color='#FF0000'>&quot;-r&quot;</font>))
76          {
77              <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;\n* * RESUMING GAME FROM LOG * *\n\n&quot;</font>);
78              <font color='#0000FF'><b>int</font></b> <a name='i'><font color='#0000FF'>i</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
79              <font color='#0000FF'><b>char</font></b> <a name='buffer'><font color='#0000FF'>buffer</font></a>[<font color='#00FFFF'><i>6</i></font>];
80              <a name='FILE'><font color='#0000FF'>FILE</font></a><b>* </b><a name='fp'><font color='#0000FF'>fp</font></a> <b>= </b><a name='fopen'><font color='#0000FF'>fopen</font></a>(<font color='#FF0000'>&quot;chesslog.txt&quot;</font><b>, </b><font color='#FF0000'>&quot;r&quot;</font>);
81              <font color='#0000FF'><b>int</font></b> <a href='#c'><font color='#0000FF'>c</font></a> <b>= </b><a name='fgetc'><font color='#0000FF'>fgetc</font></a>(<a href='#fp'><font color='#0000FF'>fp</font></a>);
82              <font color='#0000FF'><b>while</font></b> (<a href='#c'><font color='#0000FF'>c</font></a> <b>!= </b><a name='EOF'><font color='#0000FF'>EOF</font></a>)
83              {
84                  <a href='#buffer'><font color='#0000FF'>buffer</font></a>[<a href='#i'><font color='#0000FF'>i</font></a><b>++ </b>]<b>= </b>(<font color='#0000FF'><b>char</font></b>)<a href='#c'><font color='#0000FF'>c</font></a>;
85                  <font color='#0000FF'><b>if</font></b> (<a href='#c'><font color='#0000FF'>c</font></a> <b>== </b><font color='#00FFFF'><u>'\n'</u></font>)
86                  {
87                      <font color='#00FF00'>//Move read, execute it</font>
88                      <a href='#buffer'><font color='#0000FF'>buffer</font></a>[<a href='#i'><font color='#0000FF'>i</font></a>]<b>= </b><font color='#00FFFF'><u>'\0'</u></font>;
89                      <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move'><font color='#0000FF'>move</font></a> <b>= </b><a href='#strToMove'><font color='#0000FF'>strToMove</font></a>(<a href='#buffer'><font color='#0000FF'>buffer</font></a>);
90                      <font color='#0000FF'><b>if</font></b> (<a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a name='startRow'><font color='#0000FF'>startRow</font></a> <b>== </b><a name='CASTLE'><font color='#0000FF'>CASTLE</font></a>)
91                      {
92                          <font color='#00FF00'>//Set player that is castling</font>
93                          <font color='#0000FF'><b>if</font></b> (<a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>== </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a>)<a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a name='pieceId'><font color='#0000FF'>pieceId</font></a> <b>= </b><a name='KING'><font color='#0000FF'>KING</font></a>;
94                          <font color='#0000FF'><b>else</font></b> <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#pieceId'><font color='#0000FF'>pieceId</font></a> <b>= </b><a href='#KING'><font color='#0000FF'>KING</font></a> <b>+ </b><a name='BLACK'><font color='#0000FF'>BLACK</font></a>;
95                          
96                      }
97                      <a name='executeMove'><font color='#0000FF'>executeMove</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#move'><font color='#0000FF'>move</font></a><b>, </b><a href='#prev'><font color='#0000FF'>prev</font></a>);
98                      <a name='free'><font color='#0000FF'>free</font></a>(<a href='#move'><font color='#0000FF'>move</font></a>);
99                      <font color='#00FF00'>//Switch players</font>
100                     <font color='#0000FF'><b>if</font></b> (<a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>== </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a>)<a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>= </b><a href='#BLACK'><font color='#0000FF'>BLACK</font></a>;
101                     <font color='#0000FF'><b>else</font></b> <a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>= </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a>;
102                     <a href='#i'><font color='#0000FF'>i</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
103                     
104                 }
105                 <a href='#c'><font color='#0000FF'>c</font></a> <b>= </b><a href='#fgetc'><font color='#0000FF'>fgetc</font></a>(<a href='#fp'><font color='#0000FF'>fp</font></a>);
106                 
107             }
108             <a name='fclose'><font color='#0000FF'>fclose</font></a>(<a href='#fp'><font color='#0000FF'>fp</font></a>);
109             
110         }
111         <font color='#0000FF'><b>else</font></b> 
112         {
113             <font color='#00FF00'>//initialize (clear) log file</font>
114             <a href='#initLog'><font color='#0000FF'>initLog</font></a>(<font color='#FF0000'>&quot;chesslog.txt&quot;</font>);
115             
116         }
117         <font color='#00FF00'>//show board</font>
118         <a name='printBoard'><font color='#0000FF'>printBoard</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>);
119         <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;\n&quot;</font>);
120         <font color='#00FF00'>//main game loop</font>
121         <font color='#0000FF'><b>int</font></b> <a href='#i'><font color='#0000FF'>i</font></a><b>, </b><a name='j'><font color='#0000FF'>j</font></a>;
122         <font color='#0000FF'><b>while</font></b> (<a name='TRUE'><font color='#0000FF'>TRUE</font></a>)
123         {
124             <font color='#0000FF'><b>if</font></b> (<a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>== </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a>)<a href='#moves'><font color='#0000FF'>moves</font></a> <b>= </b><a name='getLegalMoves'><font color='#0000FF'>getLegalMoves</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a><b>, </b><a href='#prev'><font color='#0000FF'>prev</font></a><b>, </b><font color='#00FFFF'><i>1</i></font>);
125             <font color='#0000FF'><b>else</font></b> <a href='#moves'><font color='#0000FF'>moves</font></a> <b>= </b><a href='#getLegalMoves'><font color='#0000FF'>getLegalMoves</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#BLACK'><font color='#0000FF'>BLACK</font></a><b>, </b><a href='#prev'><font color='#0000FF'>prev</font></a><b>, </b><font color='#00FFFF'><i>1</i></font>);
126             <font color='#00FF00'>//check for checkmate/stalemate</font>
127             <font color='#0000FF'><b>if</font></b> (<a href='#moves'><font color='#0000FF'>moves</font></a><b>-&gt; </b><a name='size'><font color='#0000FF'>size</font></a> <b>== </b><font color='#00FFFF'><i>0</i></font>)
128             {
129                 <font color='#0000FF'><b>if</font></b> (<b>! </b><a name='kingInCheck'><font color='#0000FF'>kingInCheck</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a>)<b>&amp;&amp; </b><b>! </b><a href='#kingInCheck'><font color='#0000FF'>kingInCheck</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#BLACK'><font color='#0000FF'>BLACK</font></a>))
130                 {
131                     <font color='#00FF00'>//stalemate</font>
132                     <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;STALEMATE.\n&quot;</font>);
133                     
134                 }
135                 <font color='#0000FF'><b>else</font></b> 
136                 {
137                     <font color='#00FF00'>//checkmate, determine color</font>
138                     <font color='#0000FF'><b>if</font></b> (<a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>== </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a>)<a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;CHECKMATE: BLACK WINS.\n&quot;</font>);
139                     <font color='#0000FF'><b>else</font></b> <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;CHECKMATE: WHITE WINS.\n&quot;</font>);
140                     
141                 }
142                 <font color='#00FF00'>//End program</font>
143                 <a href='#sendKillSig'><font color='#0000FF'>sendKillSig</font></a>();
144                 <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>);
145                 <a href='#Finalize'><font color='#0000FF'>Finalize</font></a>();
146                 <font color='#0000FF'><b>return</font></b> <font color='#00FFFF'><i>0</i></font>;
147                 
148             }
149             <font color='#00FF00'>//execute turns (ai or human)</font>
150             <font color='#0000FF'><b>int</font></b> <a name='status'><font color='#0000FF'>status</font></a>;
151             <font color='#0000FF'><b>if</font></b> (<a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>== </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a>)
152             {
153                 <font color='#00FF00'>//white's turn</font>
154                 <a href='#status'><font color='#0000FF'>status</font></a> <b>= </b><a href='#computeMove'><font color='#0000FF'>computeMove</font></a>(<a name='TYPE_WHITE'><font color='#0000FF'>TYPE_WHITE</font></a><b>, </b><a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#moves'><font color='#0000FF'>moves</font></a><b>, </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a><b>, </b><a name='FUNCTION_WHITE'><font color='#0000FF'>FUNCTION_WHITE</font></a>);
155                 <font color='#0000FF'><b>if</font></b> (<a href='#status'><font color='#0000FF'>status</font></a> <b>== </b><font color='#00FFFF'><i>0</i></font>)
156                 {
157                     <a href='#Finalize'><font color='#0000FF'>Finalize</font></a>();
158                     <font color='#0000FF'><b>return</font></b> <font color='#00FFFF'><i>0</i></font>;
159                     
160                 }
161                 
162             }
163             <font color='#0000FF'><b>else</font></b> 
164             {
165                 <font color='#00FF00'>//black's turn</font>
166                 <a href='#status'><font color='#0000FF'>status</font></a> <b>= </b><a href='#computeMove'><font color='#0000FF'>computeMove</font></a>(<a name='TYPE_BLACK'><font color='#0000FF'>TYPE_BLACK</font></a><b>, </b><a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#moves'><font color='#0000FF'>moves</font></a><b>, </b><a href='#BLACK'><font color='#0000FF'>BLACK</font></a><b>, </b><a name='FUNCTION_BLACK'><font color='#0000FF'>FUNCTION_BLACK</font></a>);
167                 <font color='#0000FF'><b>if</font></b> (<a href='#status'><font color='#0000FF'>status</font></a> <b>== </b><font color='#00FFFF'><i>0</i></font>)
168                 {
169                     <a href='#Finalize'><font color='#0000FF'>Finalize</font></a>();
170                     <font color='#0000FF'><b>return</font></b> <font color='#00FFFF'><i>0</i></font>;
171                     
172                 }
173                 
174             }
175             <a name='destroyMoveSet'><font color='#0000FF'>destroyMoveSet</font></a>(<a href='#moves'><font color='#0000FF'>moves</font></a>);
176             <font color='#00FF00'>//Add move to queue</font>
177             <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='prevClone'><font color='#0000FF'>prevClone</font></a> <b>= </b><a name='cloneMove'><font color='#0000FF'>cloneMove</font></a>(<a href='#prev'><font color='#0000FF'>prev</font></a>);
178             <a href='#enqueueMove'><font color='#0000FF'>enqueueMove</font></a>(<a href='#prevClone'><font color='#0000FF'>prevClone</font></a>);
179             <font color='#00FF00'>//Check queue for repeats</font>
180             <font color='#0000FF'><b>if</font></b> (<a href='#moveLoopDetected'><font color='#0000FF'>moveLoopDetected</font></a>())
181             {
182                 <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;REPEATED MOVES DETECTED. GAME ENDS IN A DRAW.\n&quot;</font>);
183                 <a href='#sendKillSig'><font color='#0000FF'>sendKillSig</font></a>();
184                 <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>);
185                 <a href='#Finalize'><font color='#0000FF'>Finalize</font></a>();
186                 <font color='#0000FF'><b>return</font></b> <font color='#00FFFF'><i>0</i></font>;
187                 
188             }
189             <font color='#00FF00'>//Log move</font>
190             <a href='#logMove'><font color='#0000FF'>logMove</font></a>(<font color='#FF0000'>&quot;chesslog.txt&quot;</font><b>, </b><a href='#prev'><font color='#0000FF'>prev</font></a>);
191             <font color='#00FF00'>//Swap turns</font>
192             <font color='#0000FF'><b>if</font></b> (<a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>== </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a>)<a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>= </b><a href='#BLACK'><font color='#0000FF'>BLACK</font></a>;
193             <font color='#0000FF'><b>else</font></b> <a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a> <b>= </b><a href='#WHITE'><font color='#0000FF'>WHITE</font></a>;
194             
195         }
196         <font color='#00FF00'>//free memory</font>
197         <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>);
198         <font color='#00FF00'>//======================================================================</font>
199         
200     }
201     <font color='#0000FF'><b>else</font></b> 
202     {
203         <font color='#00FF00'>//Slave node code</font>
204         <font color='#00FF00'>//======================================================================</font>
205         <font color='#0000FF'><b>int</font></b> <a name='color'><font color='#0000FF'>color</font></a>;
206         <font color='#0000FF'><b>int</font></b> <a name='depth'><font color='#0000FF'>depth</font></a>;
207         <font color='#0000FF'><b>int</font></b> <a href='#evaluator'><font color='#0000FF'>evaluator</font></a>;
208         <font color='#0000FF'><b>char</font></b> <a href='#board'><font color='#0000FF'>board</font></a>[<font color='#00FFFF'><i>64</i></font>];
209         <font color='#0000FF'><b>while</font></b> (<a href='#TRUE'><font color='#0000FF'>TRUE</font></a>)
210         {
211             <font color='#00FF00'>//Receive data from HEAD node</font>
212             <a href='#COMM_WORLD'><font color='#0000FF'>COMM_WORLD</font></a><b>. </b><a name='Recv'><font color='#0000FF'>Recv</font></a>(<b>&amp; </b><a href='#color'><font color='#0000FF'>color</font></a><b>, </b><font color='#00FFFF'><i>1</i></font><b>, </b><a name='MPI_INT'><font color='#0000FF'>MPI_INT</font></a><b>, </b><a href='#HEAD'><font color='#0000FF'>HEAD</font></a><b>, </b><font color='#00FFFF'><i>0</i></font>);
213             <font color='#00FF00'>//Terminate program if color is -1</font>
214             <font color='#0000FF'><b>if</font></b> (<a href='#color'><font color='#0000FF'>color</font></a> <b>== </b><b>- </b><font color='#00FFFF'><i>1</i></font>)<font color='#0000FF'><b>break</font></b>;
215             <a href='#COMM_WORLD'><font color='#0000FF'>COMM_WORLD</font></a><b>. </b><a href='#Recv'><font color='#0000FF'>Recv</font></a>(<b>&amp; </b><a href='#depth'><font color='#0000FF'>depth</font></a><b>, </b><font color='#00FFFF'><i>1</i></font><b>, </b><a href='#MPI_INT'><font color='#0000FF'>MPI_INT</font></a><b>, </b><a href='#HEAD'><font color='#0000FF'>HEAD</font></a><b>, </b><font color='#00FFFF'><i>0</i></font>);
216             <a href='#COMM_WORLD'><font color='#0000FF'>COMM_WORLD</font></a><b>. </b><a href='#Recv'><font color='#0000FF'>Recv</font></a>(<b>&amp; </b><a href='#evaluator'><font color='#0000FF'>evaluator</font></a><b>, </b><font color='#00FFFF'><i>1</i></font><b>, </b><a href='#MPI_INT'><font color='#0000FF'>MPI_INT</font></a><b>, </b><a href='#HEAD'><font color='#0000FF'>HEAD</font></a><b>, </b><font color='#00FFFF'><i>0</i></font>);
217             <a href='#COMM_WORLD'><font color='#0000FF'>COMM_WORLD</font></a><b>. </b><a href='#Recv'><font color='#0000FF'>Recv</font></a>(<b>&amp; </b><a href='#board'><font color='#0000FF'>board</font></a><b>, </b><font color='#00FFFF'><i>64</i></font><b>, </b><a name='MPI_CHAR'><font color='#0000FF'>MPI_CHAR</font></a><b>, </b><a href='#HEAD'><font color='#0000FF'>HEAD</font></a><b>, </b><font color='#00FFFF'><i>0</i></font>);
218             <a href='#MoveSet'><font color='#0000FF'>MoveSet</font></a><b>* </b><a name='set'><font color='#0000FF'>set</font></a> <b>= </b><a name='receiveMoveSet'><font color='#0000FF'>receiveMoveSet</font></a>();
219             <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='prevMove'><font color='#0000FF'>prevMove</font></a> <b>= </b><a name='receiveMove'><font color='#0000FF'>receiveMove</font></a>();
220             <font color='#00FF00'>//Determine best move</font>
221             <a name='MoveDef'><font color='#0000FF'>MoveDef</font></a><b>* </b><a name='bmd'><font color='#0000FF'>bmd</font></a> <b>= </b><a name='bestMoveHelper'><font color='#0000FF'>bestMoveHelper</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#color'><font color='#0000FF'>color</font></a><b>, </b><a href='#depth'><font color='#0000FF'>depth</font></a><b>, </b><a href='#set'><font color='#0000FF'>set</font></a><b>, </b><a href='#prevMove'><font color='#0000FF'>prevMove</font></a><b>, </b><a href='#evaluator'><font color='#0000FF'>evaluator</font></a>);
222             <font color='#00FF00'>//Send MoveDef back to head node</font>
223             <a name='sendMoveDef'><font color='#0000FF'>sendMoveDef</font></a>(<a href='#bmd'><font color='#0000FF'>bmd</font></a>);
224             <font color='#00FF00'>//Free memory</font>
225             <a href='#destroyMoveSet'><font color='#0000FF'>destroyMoveSet</font></a>(<a href='#set'><font color='#0000FF'>set</font></a>);
226             <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#bmd'><font color='#0000FF'>bmd</font></a>);
227             <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#prevMove'><font color='#0000FF'>prevMove</font></a>);
228             
229         }
230         <font color='#00FF00'>//======================================================================</font>
231         
232     }
233     <font color='#00FF00'>//Finalize MPI</font>
234     <a href='#Finalize'><font color='#0000FF'>Finalize</font></a>();
235     <font color='#0000FF'><b>return</font></b> <font color='#00FFFF'><i>0</i></font>;
236     
237 }
238 <font color='#00FF00'>/*
 * Sends a signal to other processors instructing
 * them to terminate execution.
 */</font>
239 <font color='#0000FF'><b>void</font></b> <a href='#sendKillSig'><font color='#0000FF'>sendKillSig</font></a>()
240 {
241     <font color='#0000FF'><b>int</font></b> <a href='#i'><font color='#0000FF'>i</font></a>;
242     <font color='#0000FF'><b>int</font></b> <a name='sig'><font color='#0000FF'>sig</font></a> <b>= </b><b>- </b><font color='#00FFFF'><i>1</i></font>;
243     <font color='#0000FF'><b>for</font></b> (<a href='#i'><font color='#0000FF'>i</font></a> <b>= </b><font color='#00FFFF'><i>1</i></font>; <a href='#i'><font color='#0000FF'>i</font></a> <b>&lt; </b><a href='#numProcs'><font color='#0000FF'>numProcs</font></a>; <a href='#i'><font color='#0000FF'>i</font></a><b>++ </b>)<a href='#COMM_WORLD'><font color='#0000FF'>COMM_WORLD</font></a><b>. </b><a name='Send'><font color='#0000FF'>Send</font></a>(<b>&amp; </b><a href='#sig'><font color='#0000FF'>sig</font></a><b>, </b><font color='#00FFFF'><i>1</i></font><b>, </b><a href='#MPI_INT'><font color='#0000FF'>MPI_INT</font></a><b>, </b><a href='#i'><font color='#0000FF'>i</font></a><b>, </b><font color='#00FFFF'><i>0</i></font>);
244     
245 }
246 <font color='#00FF00'>/*
 * Add a move to the move queue.
 */</font>
247 <font color='#0000FF'><b>void</font></b> <a href='#enqueueMove'><font color='#0000FF'>enqueueMove</font></a>(<a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move'><font color='#0000FF'>move</font></a>)
248 {
249     <font color='#0000FF'><b>if</font></b> (<a href='#queueFull'><font color='#0000FF'>queueFull</font></a> <b>== </b><a href='#TRUE'><font color='#0000FF'>TRUE</font></a>)<a href='#free'><font color='#0000FF'>free</font></a>(<a href='#moveQueue'><font color='#0000FF'>moveQueue</font></a>[<a href='#queueIndex'><font color='#0000FF'>queueIndex</font></a>]);
250     <a href='#moveQueue'><font color='#0000FF'>moveQueue</font></a>[<a href='#queueIndex'><font color='#0000FF'>queueIndex</font></a><b>++ </b>]<b>= </b><a href='#move'><font color='#0000FF'>move</font></a>;
251     <font color='#0000FF'><b>if</font></b> (<a href='#queueIndex'><font color='#0000FF'>queueIndex</font></a> <b>&gt;= </b><a href='#MQ_SIZE'><font color='#0000FF'>MQ_SIZE</font></a>)
252     {
253         <a href='#queueFull'><font color='#0000FF'>queueFull</font></a> <b>= </b><a href='#TRUE'><font color='#0000FF'>TRUE</font></a>;
254         <a href='#queueIndex'><font color='#0000FF'>queueIndex</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
255         
256     }
257     
258 }
259 <font color='#00FF00'>/*
 * Check for repeats in the move queue.
 */</font>
260 <font color='#0000FF'><b>int</font></b> <a href='#moveLoopDetected'><font color='#0000FF'>moveLoopDetected</font></a>()
261 {
262     <font color='#00FF00'>// setup variables</font>
263     <font color='#0000FF'><b>int</font></b> <a href='#i'><font color='#0000FF'>i</font></a><b>, </b><a href='#j'><font color='#0000FF'>j</font></a><b>, </b><a name='type'><font color='#0000FF'>type</font></a><b>, </b><a name='len'><font color='#0000FF'>len</font></a><b>, </b><a name='dupCount'><font color='#0000FF'>dupCount</font></a>;
264     <font color='#0000FF'><b>int</font></b> <a name='duplicates'><font color='#0000FF'>duplicates</font></a>[<a href='#MQ_SIZE'><font color='#0000FF'>MQ_SIZE</font></a>];
265     <font color='#0000FF'><b>if</font></b> (<a href='#queueFull'><font color='#0000FF'>queueFull</font></a> <b>== </b><a href='#TRUE'><font color='#0000FF'>TRUE</font></a>)<a href='#len'><font color='#0000FF'>len</font></a> <b>= </b><a href='#MQ_SIZE'><font color='#0000FF'>MQ_SIZE</font></a>;
266     <font color='#0000FF'><b>else</font></b> <a href='#len'><font color='#0000FF'>len</font></a> <b>= </b><a href='#queueIndex'><font color='#0000FF'>queueIndex</font></a>;
267     <font color='#00FF00'>// clear duplicate array</font>
268     <font color='#0000FF'><b>for</font></b> (<a href='#i'><font color='#0000FF'>i</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>; <a href='#i'><font color='#0000FF'>i</font></a> <b>&lt; </b><a href='#len'><font color='#0000FF'>len</font></a>; <a href='#i'><font color='#0000FF'>i</font></a><b>++ </b>)<a href='#duplicates'><font color='#0000FF'>duplicates</font></a>[<a href='#i'><font color='#0000FF'>i</font></a>]<b>= </b><font color='#00FFFF'><i>0</i></font>;
269     <font color='#00FF00'>// check for duplicates</font>
270     <a href='#type'><font color='#0000FF'>type</font></a> <b>= </b><font color='#00FFFF'><i>1</i></font>;
271     <font color='#0000FF'><b>for</font></b> (<a href='#i'><font color='#0000FF'>i</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>; <a href='#i'><font color='#0000FF'>i</font></a> <b>&lt; </b><a href='#len'><font color='#0000FF'>len</font></a>; <a href='#i'><font color='#0000FF'>i</font></a><b>++ </b>)
272     {
273         <font color='#00FF00'>// go to next move if this has been classified</font>
274         <font color='#0000FF'><b>if</font></b> (<a href='#duplicates'><font color='#0000FF'>duplicates</font></a>[<a href='#i'><font color='#0000FF'>i</font></a>]<b>!= </b><font color='#00FFFF'><i>0</i></font>)<font color='#0000FF'><b>continue</font></b>;
275         <font color='#00FF00'>// classify</font>
276         <a href='#duplicates'><font color='#0000FF'>duplicates</font></a>[<a href='#i'><font color='#0000FF'>i</font></a>]<b>= </b><a href='#type'><font color='#0000FF'>type</font></a>;
277         <font color='#00FF00'>// classify next moves</font>
278         <font color='#0000FF'><b>for</font></b> (<a href='#j'><font color='#0000FF'>j</font></a> <b>= </b><a href='#i'><font color='#0000FF'>i</font></a> <b>+ </b><font color='#00FFFF'><i>1</i></font>; <a href='#j'><font color='#0000FF'>j</font></a> <b>&lt; </b><a href='#len'><font color='#0000FF'>len</font></a>; <a href='#j'><font color='#0000FF'>j</font></a><b>++ </b>)
279         {
280             <font color='#00FF00'>// skip if classified</font>
281             <font color='#0000FF'><b>if</font></b> (<a href='#duplicates'><font color='#0000FF'>duplicates</font></a>[<a href='#j'><font color='#0000FF'>j</font></a>]<b>!= </b><font color='#00FFFF'><i>0</i></font>)<font color='#0000FF'><b>continue</font></b>;
282             <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='a'><font color='#0000FF'>a</font></a> <b>= </b><a href='#moveQueue'><font color='#0000FF'>moveQueue</font></a>[<a href='#i'><font color='#0000FF'>i</font></a>];
283             <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='b'><font color='#0000FF'>b</font></a> <b>= </b><a href='#moveQueue'><font color='#0000FF'>moveQueue</font></a>[<a href='#j'><font color='#0000FF'>j</font></a>];
284             <font color='#0000FF'><b>if</font></b> (<a href='#a'><font color='#0000FF'>a</font></a><b>-&gt; </b><a href='#pieceId'><font color='#0000FF'>pieceId</font></a> <b>== </b><a href='#b'><font color='#0000FF'>b</font></a><b>-&gt; </b><a href='#pieceId'><font color='#0000FF'>pieceId</font></a> <b>&amp;&amp; </b><a href='#a'><font color='#0000FF'>a</font></a><b>-&gt; </b><a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>== </b><a href='#b'><font color='#0000FF'>b</font></a><b>-&gt; </b><a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>&amp;&amp; </b><a href='#a'><font color='#0000FF'>a</font></a><b>-&gt; </b><a name='startCol'><font color='#0000FF'>startCol</font></a> <b>== </b><a href='#b'><font color='#0000FF'>b</font></a><b>-&gt; </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>&amp;&amp; </b><a href='#a'><font color='#0000FF'>a</font></a><b>-&gt; </b><a name='endRow'><font color='#0000FF'>endRow</font></a> <b>== </b><a href='#b'><font color='#0000FF'>b</font></a><b>-&gt; </b><a href='#endRow'><font color='#0000FF'>endRow</font></a> <b>&amp;&amp; </b><a href='#a'><font color='#0000FF'>a</font></a><b>-&gt; </b><a name='endCol'><font color='#0000FF'>endCol</font></a> <b>== </b><a href='#b'><font color='#0000FF'>b</font></a><b>-&gt; </b><a href='#endCol'><font color='#0000FF'>endCol</font></a>)
285             {
286                 <font color='#00FF00'>// moves were the same</font>
287                 <a href='#duplicates'><font color='#0000FF'>duplicates</font></a>[<a href='#j'><font color='#0000FF'>j</font></a>]<b>= </b><a href='#type'><font color='#0000FF'>type</font></a>;
288                 
289             }
290             
291         }
292         <font color='#00FF00'>// next type</font>
293         <a href='#type'><font color='#0000FF'>type</font></a><b>++ </b>;
294         
295     }
296     <font color='#00FF00'>// count duplicates</font>
297     <font color='#0000FF'><b>int</font></b> <a name='playerDup'><font color='#0000FF'>playerDup</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
298     <font color='#0000FF'><b>for</font></b> (<a href='#i'><font color='#0000FF'>i</font></a> <b>= </b><font color='#00FFFF'><i>1</i></font>; <a href='#i'><font color='#0000FF'>i</font></a> <b>&lt;= </b><a href='#type'><font color='#0000FF'>type</font></a>; <a href='#i'><font color='#0000FF'>i</font></a><b>++ </b>)
299     {
300         <a href='#dupCount'><font color='#0000FF'>dupCount</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
301         <font color='#0000FF'><b>for</font></b> (<a href='#j'><font color='#0000FF'>j</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>; <a href='#j'><font color='#0000FF'>j</font></a> <b>&lt; </b><a href='#len'><font color='#0000FF'>len</font></a>; <a href='#j'><font color='#0000FF'>j</font></a><b>++ </b>)
302         {
303             <font color='#0000FF'><b>if</font></b> (<a href='#duplicates'><font color='#0000FF'>duplicates</font></a>[<a href='#j'><font color='#0000FF'>j</font></a>]<b>== </b><a href='#i'><font color='#0000FF'>i</font></a>)<a href='#dupCount'><font color='#0000FF'>dupCount</font></a><b>++ </b>;
304             
305         }
306         <font color='#0000FF'><b>if</font></b> (<a href='#dupCount'><font color='#0000FF'>dupCount</font></a> <b>&gt; </b><a name='MAX_REPEATS'><font color='#0000FF'>MAX_REPEATS</font></a>)
307         {
308             <a href='#playerDup'><font color='#0000FF'>playerDup</font></a><b>++ </b>;
309             <font color='#0000FF'><b>if</font></b> (<a href='#playerDup'><font color='#0000FF'>playerDup</font></a> <b>&gt; </b><font color='#00FFFF'><i>1</i></font>)<font color='#0000FF'><b>return</font></b> <a href='#TRUE'><font color='#0000FF'>TRUE</font></a>;
310             
311         }
312         
313     }
314     <font color='#0000FF'><b>return</font></b> <a href='#FALSE'><font color='#0000FF'>FALSE</font></a>;
315     
316 }
317 <font color='#00FF00'>/*
 * Carry out a move. Either get input from a human user or have AI compute move.
 */</font>
318 <font color='#0000FF'><b>int</font></b> <a href='#computeMove'><font color='#0000FF'>computeMove</font></a>(<font color='#0000FF'><b>int</font></b> <a href='#userType'><font color='#0000FF'>userType</font></a><b>, </b><font color='#0000FF'><b>char</font></b><b>* </b><a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#MoveSet'><font color='#0000FF'>MoveSet</font></a><b>* </b><a href='#moves'><font color='#0000FF'>moves</font></a><b>, </b><font color='#0000FF'><b>int</font></b> <a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a><b>, </b><font color='#0000FF'><b>int</font></b> <a href='#evaluator'><font color='#0000FF'>evaluator</font></a>)
319 {
320     <font color='#0000FF'><b>int</font></b> <a href='#i'><font color='#0000FF'>i</font></a>;
321     <font color='#0000FF'><b>if</font></b> (<a href='#userType'><font color='#0000FF'>userType</font></a> <b>== </b><a name='HUMAN'><font color='#0000FF'>HUMAN</font></a>)
322     {
323         <font color='#00FF00'>//Human move</font>
324         <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move'><font color='#0000FF'>move</font></a>;
325         <font color='#0000FF'><b>char</font></b> <a name='text'><font color='#0000FF'>text</font></a>[<font color='#00FFFF'><i>10</i></font>];
326         <font color='#0000FF'><b>while</font></b> (<a href='#TRUE'><font color='#0000FF'>TRUE</font></a>)
327         {
328             <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;ENTER MOVE: &quot;</font>);
329             <a name='fflush'><font color='#0000FF'>fflush</font></a>(<a name='stdout'><font color='#0000FF'>stdout</font></a>);
330             <a name='fgets'><font color='#0000FF'>fgets</font></a>(<a href='#text'><font color='#0000FF'>text</font></a><b>, </b><font color='#0000FF'><b>sizeof</font></b>(<a href='#text'><font color='#0000FF'>text</font></a>)<b>, </b><a name='stdin'><font color='#0000FF'>stdin</font></a>);
331             <font color='#00FF00'>//Check for end program request</font>
332             <font color='#0000FF'><b>if</font></b> (<a href='#streq'><font color='#0000FF'>streq</font></a>(<a href='#text'><font color='#0000FF'>text</font></a><b>, </b>(<font color='#0000FF'><b>char</font></b><b>* </b>)<font color='#FF0000'>&quot;q\n&quot;</font>))
333             {
334                 <font color='#00FF00'>//Send termination signal to slave nodes</font>
335                 <a href='#sendKillSig'><font color='#0000FF'>sendKillSig</font></a>();
336                 <font color='#00FF00'>//Exit</font>
337                 <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;Program Terminated.\n&quot;</font>);
338                 <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>);
339                 <font color='#0000FF'><b>return</font></b> <font color='#00FFFF'><i>0</i></font>;
340                 
341             }
342             <a href='#move'><font color='#0000FF'>move</font></a> <b>= </b><a href='#strToMove'><font color='#0000FF'>strToMove</font></a>(<a href='#text'><font color='#0000FF'>text</font></a>);
343             <font color='#0000FF'><b>if</font></b> (<a href='#move'><font color='#0000FF'>move</font></a> <b>!= </b><a name='NULL'><font color='#0000FF'>NULL</font></a>)
344             {
345                 <font color='#0000FF'><b>int</font></b> <a name='legalFlag'><font color='#0000FF'>legalFlag</font></a> <b>= </b><a href='#FALSE'><font color='#0000FF'>FALSE</font></a>;
346                 <font color='#00FF00'>//determine if move was legal</font>
347                 <font color='#0000FF'><b>for</font></b> (<a href='#i'><font color='#0000FF'>i</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>; <a href='#i'><font color='#0000FF'>i</font></a> <b>&lt; </b><a href='#moves'><font color='#0000FF'>moves</font></a><b>-&gt; </b><a href='#size'><font color='#0000FF'>size</font></a>; <a href='#i'><font color='#0000FF'>i</font></a><b>++ </b>)
348                 {
349                     <font color='#0000FF'><b>if</font></b> (<a href='#movesEqual'><font color='#0000FF'>movesEqual</font></a>(<a name='getMove'><font color='#0000FF'>getMove</font></a>(<a href='#moves'><font color='#0000FF'>moves</font></a><b>, </b><a href='#i'><font color='#0000FF'>i</font></a>)<b>, </b><a href='#move'><font color='#0000FF'>move</font></a>))
350                     {
351                         <a href='#legalFlag'><font color='#0000FF'>legalFlag</font></a> <b>= </b><a href='#TRUE'><font color='#0000FF'>TRUE</font></a>;
352                         <font color='#0000FF'><b>break</font></b>;
353                         
354                     }
355                     
356                 }
357                 <font color='#0000FF'><b>if</font></b> (<a href='#legalFlag'><font color='#0000FF'>legalFlag</font></a> <b>== </b><a href='#TRUE'><font color='#0000FF'>TRUE</font></a>)
358                 {
359                     <font color='#0000FF'><b>if</font></b> (<a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>== </b><a href='#CASTLE'><font color='#0000FF'>CASTLE</font></a>)<a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#pieceId'><font color='#0000FF'>pieceId</font></a> <b>= </b><a href='#KING'><font color='#0000FF'>KING</font></a>;
360                     <font color='#0000FF'><b>else</font></b> <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#pieceId'><font color='#0000FF'>pieceId</font></a> <b>= </b><a name='getPieceAt'><font color='#0000FF'>getPieceAt</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#startRow'><font color='#0000FF'>startRow</font></a><b>, </b><a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#startCol'><font color='#0000FF'>startCol</font></a>);
361                     <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a name='boardScore'><font color='#0000FF'>boardScore</font></a> <b>= </b><a name='evaluateBoard'><font color='#0000FF'>evaluateBoard</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><font color='#00FFFF'><i>1</i></font>);
362                     <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;\n&quot;</font>);
363                     <font color='#0000FF'><b>break</font></b>;
364                     
365                 }
366                 <font color='#0000FF'><b>else</font></b> 
367                 {
368                     <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;ILLEGAL MOVE!\n&quot;</font>);
369                     
370                 }
371                 
372             }
373             <font color='#0000FF'><b>else</font></b> 
374             {
375                 <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;INVALID INPUT!\n&quot;</font>);
376                 
377             }
378             
379         }
380         <a name='srand'><font color='#0000FF'>srand</font></a>((<font color='#0000FF'><b>unsigned</font></b> <font color='#0000FF'><b>int</font></b>)<a name='time'><font color='#0000FF'>time</font></a>(<a href='#NULL'><font color='#0000FF'>NULL</font></a>));
381         <font color='#00FF00'>//execute move</font>
382         <a href='#executeMove'><font color='#0000FF'>executeMove</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#move'><font color='#0000FF'>move</font></a><b>, </b><a href='#prev'><font color='#0000FF'>prev</font></a>);
383         <font color='#00FF00'>//set previous move to current</font>
384         <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#prev'><font color='#0000FF'>prev</font></a>);
385         <a href='#prev'><font color='#0000FF'>prev</font></a> <b>= </b><a href='#cloneMove'><font color='#0000FF'>cloneMove</font></a>(<a href='#move'><font color='#0000FF'>move</font></a>);
386         <font color='#00FF00'>//print output</font>
387         <a href='#printBoard'><font color='#0000FF'>printBoard</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>);
388         <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;\n&quot;</font>);
389         <a name='printMove'><font color='#0000FF'>printMove</font></a>(<a href='#move'><font color='#0000FF'>move</font></a>);
390         <a href='#printScore'><font color='#0000FF'>printScore</font></a>(<a href='#evaluateBoard'><font color='#0000FF'>evaluateBoard</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#evaluator'><font color='#0000FF'>evaluator</font></a>));
391         <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;\n&quot;</font>);
392         
393     }
394     <font color='#0000FF'><b>else</font></b> 
395     {
396         <font color='#00FF00'>//AI move</font>
397         <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a name='best'><font color='#0000FF'>best</font></a>;
398         <font color='#00FF00'>//determine best move, increase search depth if fewer pieces on board</font>
399         <font color='#0000FF'><b>if</font></b> (<a name='totalPieces'><font color='#0000FF'>totalPieces</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>)<b>&gt; </b><font color='#00FFFF'><i>9</i></font>)<a href='#best'><font color='#0000FF'>best</font></a> <b>= </b><a name='bestMove'><font color='#0000FF'>bestMove</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a><b>, </b><a href='#prev'><font color='#0000FF'>prev</font></a><b>, </b><a name='SEARCH_DEPTH'><font color='#0000FF'>SEARCH_DEPTH</font></a><b>, </b><a href='#evaluator'><font color='#0000FF'>evaluator</font></a>);
400         <font color='#0000FF'><b>else</font></b> <font color='#0000FF'><b>if</font></b> (<a href='#totalPieces'><font color='#0000FF'>totalPieces</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>)<b>&gt; </b><font color='#00FFFF'><i>5</i></font>)<a href='#best'><font color='#0000FF'>best</font></a> <b>= </b><a href='#bestMove'><font color='#0000FF'>bestMove</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a><b>, </b><a href='#prev'><font color='#0000FF'>prev</font></a><b>, </b><a href='#SEARCH_DEPTH'><font color='#0000FF'>SEARCH_DEPTH</font></a> <b>+ </b><font color='#00FFFF'><i>1</i></font><b>, </b><a href='#evaluator'><font color='#0000FF'>evaluator</font></a>);
401         <font color='#0000FF'><b>else</font></b> <a href='#best'><font color='#0000FF'>best</font></a> <b>= </b><a href='#bestMove'><font color='#0000FF'>bestMove</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#colorFlag'><font color='#0000FF'>colorFlag</font></a><b>, </b><a href='#prev'><font color='#0000FF'>prev</font></a><b>, </b><a href='#SEARCH_DEPTH'><font color='#0000FF'>SEARCH_DEPTH</font></a> <b>+ </b><font color='#00FFFF'><i>2</i></font><b>, </b><a href='#evaluator'><font color='#0000FF'>evaluator</font></a>);
402         <font color='#0000FF'><b>if</font></b> (<a href='#best'><font color='#0000FF'>best</font></a> <b>== </b><a href='#NULL'><font color='#0000FF'>NULL</font></a>)
403         {
404             <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;CHECKMATE: WHITE WINS.\n&quot;</font>);
405             <font color='#00FF00'>//End program</font>
406             <a href='#sendKillSig'><font color='#0000FF'>sendKillSig</font></a>();
407             <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>);
408             <font color='#0000FF'><b>return</font></b> <font color='#00FFFF'><i>0</i></font>;
409             
410         }
411         <font color='#0000FF'><b>else</font></b> 
412         {
413             <font color='#00FF00'>//execute best move</font>
414             <a href='#executeMove'><font color='#0000FF'>executeMove</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#best'><font color='#0000FF'>best</font></a><b>, </b><a href='#prev'><font color='#0000FF'>prev</font></a>);
415             <font color='#00FF00'>//set previous move to current</font>
416             <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#prev'><font color='#0000FF'>prev</font></a>);
417             <a href='#prev'><font color='#0000FF'>prev</font></a> <b>= </b><a href='#cloneMove'><font color='#0000FF'>cloneMove</font></a>(<a href='#best'><font color='#0000FF'>best</font></a>);
418             <font color='#00FF00'>//print output</font>
419             <a href='#printBoard'><font color='#0000FF'>printBoard</font></a>(<a href='#board'><font color='#0000FF'>board</font></a>);
420             <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;\n&quot;</font>);
421             <a href='#printMove'><font color='#0000FF'>printMove</font></a>(<a href='#best'><font color='#0000FF'>best</font></a>);
422             <a href='#printScore'><font color='#0000FF'>printScore</font></a>(<a href='#evaluateBoard'><font color='#0000FF'>evaluateBoard</font></a>(<a href='#board'><font color='#0000FF'>board</font></a><b>, </b><a href='#evaluator'><font color='#0000FF'>evaluator</font></a>));
423             <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;\n&quot;</font>);
424             
425         }
426         
427     }
428     <font color='#0000FF'><b>return</font></b> <font color='#00FFFF'><i>1</i></font>;
429     
430 }
431 <font color='#00FF00'>/*
 * Determine if two moves are equal.
 */</font>
432 <font color='#0000FF'><b>int</font></b> <a href='#movesEqual'><font color='#0000FF'>movesEqual</font></a>(<a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move1'><font color='#0000FF'>move1</font></a><b>, </b><a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move2'><font color='#0000FF'>move2</font></a>)
433 {
434     <font color='#0000FF'><b>if</font></b> (<a href='#move1'><font color='#0000FF'>move1</font></a><b>-&gt; </b><a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>== </b><a href='#move2'><font color='#0000FF'>move2</font></a><b>-&gt; </b><a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>&amp;&amp; </b><a href='#move1'><font color='#0000FF'>move1</font></a><b>-&gt; </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>== </b><a href='#move2'><font color='#0000FF'>move2</font></a><b>-&gt; </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>&amp;&amp; </b><a href='#move1'><font color='#0000FF'>move1</font></a><b>-&gt; </b><a href='#endRow'><font color='#0000FF'>endRow</font></a> <b>== </b><a href='#move2'><font color='#0000FF'>move2</font></a><b>-&gt; </b><a href='#endRow'><font color='#0000FF'>endRow</font></a> <b>&amp;&amp; </b><a href='#move1'><font color='#0000FF'>move1</font></a><b>-&gt; </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>== </b><a href='#move2'><font color='#0000FF'>move2</font></a><b>-&gt; </b><a href='#endCol'><font color='#0000FF'>endCol</font></a>)<font color='#0000FF'><b>return</font></b> <a href='#TRUE'><font color='#0000FF'>TRUE</font></a>;
435     <font color='#0000FF'><b>else</font></b> <font color='#0000FF'><b>return</font></b> <a href='#FALSE'><font color='#0000FF'>FALSE</font></a>;
436     
437 }
438 <font color='#00FF00'>/*
 * Convert string to move.
 */</font>
439 <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#strToMove'><font color='#0000FF'>strToMove</font></a>(<font color='#0000FF'><b>char</font></b><b>* </b><a href='#str'><font color='#0000FF'>str</font></a>)
440 {
441     <font color='#0000FF'><b>if</font></b> (<a href='#toUpperCase'><font color='#0000FF'>toUpperCase</font></a>(<a href='#str'><font color='#0000FF'>str</font></a>[<font color='#00FFFF'><i>0</i></font>])<b>== </b><font color='#00FFFF'><u>'C'</u></font><b>&amp;&amp; </b><a href='#toUpperCase'><font color='#0000FF'>toUpperCase</font></a>(<a href='#str'><font color='#0000FF'>str</font></a>[<font color='#00FFFF'><i>1</i></font>])<b>== </b><font color='#00FFFF'><u>'K'</u></font>)
442     {
443         <font color='#00FF00'>//kingside castle</font>
444         <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move'><font color='#0000FF'>move</font></a> <b>= </b>(<a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b>)<a href='#malloc'><font color='#0000FF'>malloc</font></a>(<font color='#0000FF'><b>sizeof</font></b>(<a href='#Move'><font color='#0000FF'>Move</font></a>));
445         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>= </b><a href='#CASTLE'><font color='#0000FF'>CASTLE</font></a>;
446         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><a href='#CASTLE'><font color='#0000FF'>CASTLE</font></a>;
447         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#endRow'><font color='#0000FF'>endRow</font></a> <b>= </b><a name='KINGSIDE'><font color='#0000FF'>KINGSIDE</font></a>;
448         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><a href='#KINGSIDE'><font color='#0000FF'>KINGSIDE</font></a>;
449         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#pieceId'><font color='#0000FF'>pieceId</font></a> <b>= </b><a name='EMPTY'><font color='#0000FF'>EMPTY</font></a>;
450         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#boardScore'><font color='#0000FF'>boardScore</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
451         <font color='#0000FF'><b>return</font></b> <a href='#move'><font color='#0000FF'>move</font></a>;
452         
453     }
454     <font color='#0000FF'><b>else</font></b> <font color='#0000FF'><b>if</font></b> (<a href='#toUpperCase'><font color='#0000FF'>toUpperCase</font></a>(<a href='#str'><font color='#0000FF'>str</font></a>[<font color='#00FFFF'><i>0</i></font>])<b>== </b><font color='#00FFFF'><u>'C'</u></font><b>&amp;&amp; </b><a href='#toUpperCase'><font color='#0000FF'>toUpperCase</font></a>(<a href='#str'><font color='#0000FF'>str</font></a>[<font color='#00FFFF'><i>1</i></font>])<b>== </b><font color='#00FFFF'><u>'Q'</u></font>)
455     {
456         <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;CASTLE QUEEN\n&quot;</font>);
457         <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move'><font color='#0000FF'>move</font></a> <b>= </b>(<a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b>)<a href='#malloc'><font color='#0000FF'>malloc</font></a>(<font color='#0000FF'><b>sizeof</font></b>(<a href='#Move'><font color='#0000FF'>Move</font></a>));
458         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>= </b><a href='#CASTLE'><font color='#0000FF'>CASTLE</font></a>;
459         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><a href='#CASTLE'><font color='#0000FF'>CASTLE</font></a>;
460         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#endRow'><font color='#0000FF'>endRow</font></a> <b>= </b><a name='QUEENSIDE'><font color='#0000FF'>QUEENSIDE</font></a>;
461         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><a href='#QUEENSIDE'><font color='#0000FF'>QUEENSIDE</font></a>;
462         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#pieceId'><font color='#0000FF'>pieceId</font></a> <b>= </b><a href='#EMPTY'><font color='#0000FF'>EMPTY</font></a>;
463         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#boardScore'><font color='#0000FF'>boardScore</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
464         <font color='#0000FF'><b>return</font></b> <a href='#move'><font color='#0000FF'>move</font></a>;
465         
466     }
467     <font color='#0000FF'><b>else</font></b> <font color='#0000FF'><b>if</font></b> (<a name='strlen'><font color='#0000FF'>strlen</font></a>(<a href='#str'><font color='#0000FF'>str</font></a>)<b>&lt; </b><font color='#00FFFF'><i>4</i></font>)
468     {
469         <font color='#0000FF'><b>return</font></b> <a href='#NULL'><font color='#0000FF'>NULL</font></a>;
470         
471     }
472     <font color='#0000FF'><b>else</font></b> 
473     {
474         <font color='#0000FF'><b>int</font></b> <a href='#startRow'><font color='#0000FF'>startRow</font></a><b>, </b><a href='#startCol'><font color='#0000FF'>startCol</font></a><b>, </b><a href='#endRow'><font color='#0000FF'>endRow</font></a><b>, </b><a href='#endCol'><font color='#0000FF'>endCol</font></a>;
475         <font color='#0000FF'><b>char</font></b> <a name='startc'><font color='#0000FF'>startc</font></a><b>, </b><a name='endc'><font color='#0000FF'>endc</font></a>;
476         <a href='#startc'><font color='#0000FF'>startc</font></a> <b>= </b><a href='#toUpperCase'><font color='#0000FF'>toUpperCase</font></a>(<a href='#str'><font color='#0000FF'>str</font></a>[<font color='#00FFFF'><i>0</i></font>]);
477         <a href='#endc'><font color='#0000FF'>endc</font></a> <b>= </b><a href='#toUpperCase'><font color='#0000FF'>toUpperCase</font></a>(<a href='#str'><font color='#0000FF'>str</font></a>[<font color='#00FFFF'><i>2</i></font>]);
478         <font color='#0000FF'><b>switch</font></b> (<a href='#startc'><font color='#0000FF'>startc</font></a>)
479         {
480             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'A'</u></font><b>: </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
481             <font color='#0000FF'><b>break</font></b>;
482             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'B'</u></font><b>: </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><font color='#00FFFF'><i>1</i></font>;
483             <font color='#0000FF'><b>break</font></b>;
484             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'C'</u></font><b>: </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><font color='#00FFFF'><i>2</i></font>;
485             <font color='#0000FF'><b>break</font></b>;
486             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'D'</u></font><b>: </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><font color='#00FFFF'><i>3</i></font>;
487             <font color='#0000FF'><b>break</font></b>;
488             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'E'</u></font><b>: </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><font color='#00FFFF'><i>4</i></font>;
489             <font color='#0000FF'><b>break</font></b>;
490             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'F'</u></font><b>: </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><font color='#00FFFF'><i>5</i></font>;
491             <font color='#0000FF'><b>break</font></b>;
492             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'G'</u></font><b>: </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><font color='#00FFFF'><i>6</i></font>;
493             <font color='#0000FF'><b>break</font></b>;
494             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'H'</u></font><b>: </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b><font color='#00FFFF'><i>7</i></font>;
495             <font color='#0000FF'><b>break</font></b>;
496             <font color='#0000FF'><b>default</font></b><b>: </b><font color='#0000FF'><b>return</font></b> <a href='#NULL'><font color='#0000FF'>NULL</font></a>;
497             
498         }
499         <a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>= </b><a href='#str'><font color='#0000FF'>str</font></a>[<font color='#00FFFF'><i>1</i></font>]<b>- </b><font color='#00FFFF'><i>48</i></font><b>- </b><font color='#00FFFF'><i>1</i></font>;
500         <font color='#0000FF'><b>if</font></b> (<a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>&gt; </b><font color='#00FFFF'><i>7</i></font><b>|| </b><a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>&lt; </b><font color='#00FFFF'><i>0</i></font>)<font color='#0000FF'><b>return</font></b> <a href='#NULL'><font color='#0000FF'>NULL</font></a>;
501         <font color='#0000FF'><b>switch</font></b> (<a href='#endc'><font color='#0000FF'>endc</font></a>)
502         {
503             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'A'</u></font><b>: </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
504             <font color='#0000FF'><b>break</font></b>;
505             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'B'</u></font><b>: </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><font color='#00FFFF'><i>1</i></font>;
506             <font color='#0000FF'><b>break</font></b>;
507             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'C'</u></font><b>: </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><font color='#00FFFF'><i>2</i></font>;
508             <font color='#0000FF'><b>break</font></b>;
509             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'D'</u></font><b>: </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><font color='#00FFFF'><i>3</i></font>;
510             <font color='#0000FF'><b>break</font></b>;
511             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'E'</u></font><b>: </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><font color='#00FFFF'><i>4</i></font>;
512             <font color='#0000FF'><b>break</font></b>;
513             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'F'</u></font><b>: </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><font color='#00FFFF'><i>5</i></font>;
514             <font color='#0000FF'><b>break</font></b>;
515             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'G'</u></font><b>: </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><font color='#00FFFF'><i>6</i></font>;
516             <font color='#0000FF'><b>break</font></b>;
517             <font color='#0000FF'><b>case</font></b> <font color='#00FFFF'><u>'H'</u></font><b>: </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b><font color='#00FFFF'><i>7</i></font>;
518             <font color='#0000FF'><b>break</font></b>;
519             <font color='#0000FF'><b>default</font></b><b>: </b><font color='#0000FF'><b>return</font></b> <a href='#NULL'><font color='#0000FF'>NULL</font></a>;
520             
521         }
522         <a href='#endRow'><font color='#0000FF'>endRow</font></a> <b>= </b><a href='#str'><font color='#0000FF'>str</font></a>[<font color='#00FFFF'><i>3</i></font>]<b>- </b><font color='#00FFFF'><i>48</i></font><b>- </b><font color='#00FFFF'><i>1</i></font>;
523         <font color='#0000FF'><b>if</font></b> (<a href='#endRow'><font color='#0000FF'>endRow</font></a> <b>&gt; </b><font color='#00FFFF'><i>7</i></font><b>|| </b><a href='#endRow'><font color='#0000FF'>endRow</font></a> <b>&lt; </b><font color='#00FFFF'><i>0</i></font>)<font color='#0000FF'><b>return</font></b> <a href='#NULL'><font color='#0000FF'>NULL</font></a>;
524         <a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move'><font color='#0000FF'>move</font></a> <b>= </b>(<a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b>)<a href='#malloc'><font color='#0000FF'>malloc</font></a>(<font color='#0000FF'><b>sizeof</font></b>(<a href='#Move'><font color='#0000FF'>Move</font></a>));
525         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#startRow'><font color='#0000FF'>startRow</font></a> <b>= </b>(<font color='#0000FF'><b>char</font></b>)<a href='#startRow'><font color='#0000FF'>startRow</font></a>;
526         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#startCol'><font color='#0000FF'>startCol</font></a> <b>= </b>(<font color='#0000FF'><b>char</font></b>)<a href='#startCol'><font color='#0000FF'>startCol</font></a>;
527         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#endRow'><font color='#0000FF'>endRow</font></a> <b>= </b>(<font color='#0000FF'><b>char</font></b>)<a href='#endRow'><font color='#0000FF'>endRow</font></a>;
528         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#endCol'><font color='#0000FF'>endCol</font></a> <b>= </b>(<font color='#0000FF'><b>char</font></b>)<a href='#endCol'><font color='#0000FF'>endCol</font></a>;
529         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#pieceId'><font color='#0000FF'>pieceId</font></a> <b>= </b><a href='#EMPTY'><font color='#0000FF'>EMPTY</font></a>;
530         <a href='#move'><font color='#0000FF'>move</font></a><b>-&gt; </b><a href='#boardScore'><font color='#0000FF'>boardScore</font></a> <b>= </b><font color='#00FFFF'><i>0</i></font>;
531         <font color='#0000FF'><b>return</font></b> <a href='#move'><font color='#0000FF'>move</font></a>;
532         
533     }
534     
535 }
536 <font color='#00FF00'>/*
 * Print a board score.
 */</font>
537 <font color='#0000FF'><b>void</font></b> <a href='#printScore'><font color='#0000FF'>printScore</font></a>(<font color='#0000FF'><b>int</font></b> <a href='#score'><font color='#0000FF'>score</font></a>)
538 {
539     <font color='#0000FF'><b>if</font></b> (<a href='#score'><font color='#0000FF'>score</font></a> <b>&gt; </b><font color='#00FFFF'><i>0</i></font>)<a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;Board Score = %d (WHITE).\n&quot;</font><b>, </b><a href='#score'><font color='#0000FF'>score</font></a>);
540     <font color='#0000FF'><b>else</font></b> <font color='#0000FF'><b>if</font></b> (<a href='#score'><font color='#0000FF'>score</font></a> <b>&lt; </b><font color='#00FFFF'><i>0</i></font>)<a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;Board Score = %d (BLACK).\n&quot;</font><b>, </b><b>- </b><a href='#score'><font color='#0000FF'>score</font></a>);
541     <font color='#0000FF'><b>else</font></b> <a href='#printf'><font color='#0000FF'>printf</font></a>(<font color='#FF0000'>&quot;Board Score = EVEN.\n&quot;</font>);
542     
543 }
544 <font color='#00FF00'>/* Returns an upper case version of a character. */</font>
545 <font color='#0000FF'><b>char</font></b> <a href='#toUpperCase'><font color='#0000FF'>toUpperCase</font></a>(<font color='#0000FF'><b>int</font></b> <a href='#c'><font color='#0000FF'>c</font></a>)
546 {
547     <font color='#0000FF'><b>if</font></b> (<a href='#c'><font color='#0000FF'>c</font></a> <b>&gt;= </b><font color='#00FFFF'><i>97</i></font><b>&amp;&amp; </b><a href='#c'><font color='#0000FF'>c</font></a> <b>&lt;= </b><font color='#00FFFF'><i>122</i></font>)
548     {
549         <font color='#0000FF'><b>return</font></b> (<font color='#0000FF'><b>char</font></b>)(<a href='#c'><font color='#0000FF'>c</font></a> <b>- </b><font color='#00FFFF'><i>32</i></font>);
550         
551     }
552     <font color='#0000FF'><b>else</font></b> 
553     {
554         <font color='#0000FF'><b>return</font></b> (<font color='#0000FF'><b>char</font></b>)<a href='#c'><font color='#0000FF'>c</font></a>;
555         
556     }
557     
558 }
559 <font color='#00FF00'>/* Clears log file. */</font>
560 <font color='#0000FF'><b>void</font></b> <a href='#initLog'><font color='#0000FF'>initLog</font></a>(<font color='#0000FF'><b>const</font></b> <font color='#0000FF'><b>char</font></b><b>* </b><a href='#filename'><font color='#0000FF'>filename</font></a>)
561 {
562     <a href='#FILE'><font color='#0000FF'>FILE</font></a><b>* </b><a href='#fp'><font color='#0000FF'>fp</font></a> <b>= </b><a href='#fopen'><font color='#0000FF'>fopen</font></a>(<a href='#filename'><font color='#0000FF'>filename</font></a><b>, </b><font color='#FF0000'>&quot;w&quot;</font>);
563     <a name='fprintf'><font color='#0000FF'>fprintf</font></a>(<a href='#fp'><font color='#0000FF'>fp</font></a><b>, </b><font color='#FF0000'>&quot;&quot;</font>);
564     <a href='#fclose'><font color='#0000FF'>fclose</font></a>(<a href='#fp'><font color='#0000FF'>fp</font></a>);
565     
566 }
567 <font color='#00FF00'>/* Logs a textual representation of a move in a file. */</font>
568 <font color='#0000FF'><b>void</font></b> <a href='#logMove'><font color='#0000FF'>logMove</font></a>(<font color='#0000FF'><b>const</font></b> <font color='#0000FF'><b>char</font></b><b>* </b><a href='#filename'><font color='#0000FF'>filename</font></a><b>, </b><a href='#Move'><font color='#0000FF'>Move</font></a><b>* </b><a href='#move'><font color='#0000FF'>move</font></a>)
569 {
570     <font color='#00FF00'>//Open file</font>
571     <a href='#FILE'><font color='#0000FF'>FILE</font></a><b>* </b><a href='#fp'><font color='#0000FF'>fp</font></a> <b>= </b><a href='#fopen'><font color='#0000FF'>fopen</font></a>(<a href='#filename'><font color='#0000FF'>filename</font></a><b>, </b><font color='#FF0000'>&quot;a&quot;</font>);
572     <font color='#00FF00'>//Log move</font>
573     <font color='#0000FF'><b>char</font></b><b>* </b><a name='moveStr'><font color='#0000FF'>moveStr</font></a> <b>= </b><a name='moveToString'><font color='#0000FF'>moveToString</font></a>(<a href='#move'><font color='#0000FF'>move</font></a>);
574     <a href='#fprintf'><font color='#0000FF'>fprintf</font></a>(<a href='#fp'><font color='#0000FF'>fp</font></a><b>, </b><font color='#FF0000'>&quot;%s&quot;</font><b>, </b><a href='#moveStr'><font color='#0000FF'>moveStr</font></a>);
575     <a href='#free'><font color='#0000FF'>free</font></a>(<a href='#moveStr'><font color='#0000FF'>moveStr</font></a>);
576     <font color='#00FF00'>//Close file</font>
577     <a href='#fclose'><font color='#0000FF'>fclose</font></a>(<a href='#fp'><font color='#0000FF'>fp</font></a>);
578     
579 }
580 
</pre></html>
